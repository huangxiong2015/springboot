<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.yikuyi.party.partycode.dao.PartyCodeDao">
	
	<!-- 新增PARTY_CODE编码 -->
	<insert id="insertPartyCode" parameterType="com.yikuyi.party.partycode.model.PartyCode" >
		INSERT INTO PARTY_CODE(CODE_PREFIX, CODE_NUM, CREATOR, CREATED_DATE, LAST_UPDATE_USER, LAST_UPDATE_DATE)
		VALUES
		(
			#{codePrefix},
			#{codeNum},
			#{creator},
			NOW(),
			#{lastUpdateUser},
			NOW()
		)
	</insert>
	
	<update id="updatePartyCode" parameterType="com.yikuyi.party.partycode.model.PartyCode">
		UPDATE PARTY_CODE SET CODE_NUM = CODE_NUM+1 WHERE CODE_PREFIX = #{codePrefix}
	</update>
	
	<select id="getNumByPrefix" parameterType="java.lang.String" resultType="java.lang.String">
		SELECT LPAD(CODE_NUM+1,3,0) AS code_num FROM PARTY_CODE WHERE CODE_PREFIX = #{codePrefix}
	</select>
	
</mapper>