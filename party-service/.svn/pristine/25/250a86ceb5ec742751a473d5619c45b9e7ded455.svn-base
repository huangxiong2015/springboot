<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.yikuyi.party.contact.dao.ContactMechDao">

	<resultMap id="ResultAll" type="com.yikuyi.party.contact.model.ContactMech">
		<id column="CONTACT_MECH_ID" property="id" jdbcType="VARCHAR" />
		<result column="CONTACT_MECH_ALIAS" property="alias" jdbcType="VARCHAR" />
		<result column="INFO_STRING" property="email" jdbcType="VARCHAR" />
		<!-- 用户地址信息 -->
		<association property="postalAddress"
			javaType="com.yikuyi.party.contact.model.PostalAddress">
			<result column="TO_NAME" property="toName" jdbcType="VARCHAR" />
			<result column="ATTN_NAME" property="attnName" jdbcType="VARCHAR" />
			<result column="ADDRESS1" property="address1" jdbcType="VARCHAR" />
			<result column="ADDRESS2" property="address2" jdbcType="VARCHAR" />
			<result column="POSTAL_CODE" property="postalCode" jdbcType="VARCHAR" />
			<result column="COUNTRY_GEO_NAME" property="countryGeoName"
				jdbcType="VARCHAR" />
			<result column="COUNTRY_GEO_ID" property="countryGeoId"
				jdbcType="VARCHAR" />
			<result column="PROVINCE_GEO_NAME" property="provinceGeoName"
				jdbcType="VARCHAR" />
			<result column="PROVINCE_GEO_ID" property="provinceGeoId"
				jdbcType="VARCHAR" />
			<result column="COUNTY_GEO_NAME" property="countyGeoName"
				jdbcType="VARCHAR" />
			<result column="COUNTY_GEO_ID" property="countyGeoId"
				jdbcType="VARCHAR" />
			<result column="CITY_GEO_NAME" property="cityGeoName"
				jdbcType="VARCHAR" />
			<result column="CITY_GEO_ID" property="cityGeoId" jdbcType="VARCHAR" />
		</association>
	</resultMap>

	<select id="getContactMechByIds" resultMap="ResultAll">
		SELECT
		a.CONTACT_MECH_ID,
		a.CONTACT_MECH_ALIAS,
		a.INFO_STRING,

		b.TO_NAME,
		b.ATTN_NAME,
		b.ADDRESS1,
		b.ADDRESS2,
		b.POSTAL_CODE,
		b.COUNTRY_GEO_NAME,
		b.COUNTRY_GEO_ID,
		b.PROVINCE_GEO_NAME,
		b.PROVINCE_GEO_ID,
		b.COUNTY_GEO_NAME,
		b.COUNTY_GEO_ID,
		b.CITY_GEO_NAME,
		b.CITY_GEO_ID
		FROM
		CONTACT_MECH a
		LEFT JOIN POSTAL_ADDRESS b
		ON a.CONTACT_MECH_ID =
		b.CONTACT_MECH_ID
		WHERE a.CONTACT_MECH_ID IN
		<foreach item="item" index="index" collection="list" open="("
			separator="," close=")">#{item}</foreach>
	</select>

	<insert id="insert" parameterType="com.yikuyi.party.contact.model.ContactMech">
		insert into CONTACT_MECH
		<trim prefix="(" suffix=")" suffixOverrides=",">
			<if test="id != null">
				CONTACT_MECH_ID,
			</if>
			<if test="alias != null">
				CONTACT_MECH_ALIAS,
			</if>
			<if test="email != null">
				INFO_STRING,
			</if>
			<if test="verified != null">
				VERIFIED,
			</if>

			<if test="creator != null">
				CREATOR,
			</if>
			<if test="createdDate != null">
				CREATED_DATE,
			</if>

			<if test="lastUpdateUser != null">
				LAST_UPDATE_USER,
			</if>
			<if test="lastUpdateDate != null">
				LAST_UPDATE_DATE,
			</if>
		</trim>
		<trim prefix="values (" suffix=")" suffixOverrides=",">
			<if test="id != null">
				#{id,jdbcType=VARCHAR},
			</if>
			<if test="alias != null">
				#{alias,jdbcType=VARCHAR},
			</if>
			<if test="email != null">
				#{email,jdbcType=VARCHAR},
			</if>
			<if test="verified != null">
				#{verified,jdbcType=CHAR},
			</if>

			<if test="creator != null">
				#{creator,jdbcType=VARCHAR},
			</if>
			<if test="createdDate != null">
				#{createdDate,jdbcType=TIMESTAMP},
			</if>

			<if test="lastUpdateUser != null">
				#{lastUpdateUser,jdbcType=VARCHAR},
			</if>
			<if test="lastUpdateDate != null">
				#{lastUpdateDate,jdbcType=TIMESTAMP},
			</if>

		</trim>
	</insert>

</mapper>