<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.yikuyi.party.partycode.dao.PartyCodeDao">
	
	<!-- 新增PARTY_CODE编码 -->
	<insert id="insertPartyCode" parameterType="com.yikuyi.party.partycode.model.PartyCode" >
		<selectKey resultType="java.lang.String" keyProperty="codeNumStr">
			SELECT LPAD(getPartyCodeNum(#{codePrefix,jdbcType=VARCHAR}),3,0)
		</selectKey>
		INSERT INTO PARTY_CODE
		(PARTY_ID, CODE_PREFIX, CODE_NUM, CREATOR, CREATED_DATE, LAST_UPDATE_USER, LAST_UPDATE_DATE)
		VALUES
		(
			#{partyId,jdbcType=VARCHAR},
			#{codePrefix,jdbcType=VARCHAR},
			getPartyCodeNum(#{codePrefix,jdbcType=VARCHAR})+1,
			#{creator,jdbcType=VARCHAR},
			NOW(),
			#{lastUpdateUser,jdbcType=VARCHAR},
			NOW()
		)
	</insert>
	
</mapper>