<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.yikuyi.party.partySupplier.dao.PartySupplierDao">
	
  <insert id="insert" parameterType="com.yikuyi.party.vendor.vo.PartySupplier">
  
		insert into PARTY_SUPPLIER
		<trim prefix="(" suffix=")" suffixOverrides=",">
			<if test="partyId != null">
				PARTY_ID,
			</if>
			<if test="region != null">
				REGION,
			</if>
			<if test="category != null">
				CATEGORY,
			</if>
			<if test="generalHeadquarters != null">
				GENERAL_HEADQUARTERS,
			</if>
			<if test="genre != null">
				GENRE,
			</if>
			<if test="listed != null">
				LISTED,
			</if>
			<if test="stockCode != null">
				STOCK_CODE,
			</if>
			<if test="isCore != null">
				IS_CORE,
			</if>
			<if test="vendorMovStatus != null">
				VENDOR_MOV_STATUS,
			</if>
			<if test="skuMovStatus != null">
				SKU_MOV_STATUS,
			</if>
			<if test="orderVerify != null">
				ORDER_VERIFY,
			</if>
			<if test="isShowName != null">
				IS_SHOW_NAME,
			</if>
			<if test="isSupPrice != null">
				IS_SUP_PRICE,
			</if>
			<if test="supportCurrency != null">
				SUPPORT_CURRENCY,
			</if>
			<if test="description != null">
				DESCRIPTION,
			</if>
			<if test="comments != null">
				COMMENTS,
			</if>
			<if test="minOrderPriceCNY != null">
				MIN_ORDER_AMOUNT_CNY,
			</if>
			<if test="minOrderPriceUSD != null">
				MIN_ORDER_AMOUNT_USD,
			</if>
			<if test="supplierStatus != null">
				SUPPLIER_STATUS,
			</if>
			<if test="creator != null">
				CREATOR,
			</if>
			<if test="createdDate != null">
				CREATED_DATE,
			</if>
			<if test="lastUpdateUser != null">
				LAST_UPDATE_USER,
			</if>
			<if test="lastUpdateDate != null">
				LAST_UPDATE_DATE,
			</if>
		</trim>
		<trim prefix="values (" suffix=")" suffixOverrides=",">
			<if test="partyId != null">
				#{partyId},
			</if>
			<if test="region != null">
				#{region},
			</if>
			<if test="category != null">
				#{category},
			</if>
			<if test="generalHeadquarters != null">
				#{generalHeadquarters},
			</if>
			<if test="genre != null">
				#{genre},
			</if>
			<if test="listed != null">
				#{listed},
			</if>
			<if test="stockCode != null">
				#{stockCode},
			</if>
			<if test="isCore != null">
				#{isCore},
			</if>
			<if test="vendorMovStatus != null">
				#{vendorMovStatus},
			</if>
			<if test="skuMovStatus != null">
				#{skuMovStatus},
			</if>
			<if test="orderVerify != null">
				#{orderVerify},
			</if>
			<if test="isShowName != null">
				#{isShowName},
			</if>
			<if test="isSupPrice != null">
				#{isSupPrice},
			</if>
			<if test="supportCurrency != null">
				#{supportCurrency},
			</if>
			<if test="description != null">
				#{description},
			</if>
			<if test="comments != null">
				#{comments},
			</if>
			<if test="minOrderPriceCNY != null">
				#{minOrderPriceCNY},
			</if>
			<if test="minOrderPriceUSD != null">
				#{minOrderPriceUSD},
			</if>
			<if test="supplierStatus != null">
				#{supplierStatus},
			</if>
			<if test="creator != null">
				#{creator,jdbcType=VARCHAR},
			</if>
			<if test="createdDate != null">
				#{createdDate,jdbcType=TIMESTAMP},
			</if>
			<if test="lastUpdateUser != null">
				#{lastUpdateUser,jdbcType=VARCHAR},
			</if>
			<if test="lastUpdateDate != null">
				#{lastUpdateDate,jdbcType=TIMESTAMP},
			</if>
		</trim>
	</insert>
	
	<update id="updateVendorSaleInfoVo" parameterType="com.yikuyi.party.vendor.vo.VendorSaleInfoVo" >
     update PARTY_SUPPLIER SET   
         VENDOR_MOV_STATUS = #{vendorMovStatus},				
		 SKU_MOV_STATUS = #{skuMovStatus},	
		 ORDER_VERIFY = #{orderVerify},
		 IS_SHOW_NAME = #{isShowName},				
		 SUPPORT_CURRENCY = #{supportCurrency},	
		 DESCRIPTION = #{description},		
		 MIN_ORDER_AMOUNT_CNY = #{minOrderPriceCNY},		
		 MIN_ORDER_AMOUNT_USD = #{minOrderPriceUSD},		
   		 LAST_UPDATE_USER = #{lastUpdateUser},	
		 LAST_UPDATE_DATE = #{lastUpdateDate},
		
		 IS_AUTO_INTEGRATE_QTY = #{isAutoIntegrateQty}
		 <if test="productInvalidDays != null and productInvalidDays !=''"> 
		 , PRODUCT_INVALID_DAYS = #{productInvalidDays}
		 </if>
	 where PARTY_ID = #{partyId}
  </update>
  
  <select id="getOrderVerify" resultType="com.yikuyi.party.vendor.vo.PartySupplier" >
  	 select PARTY_ID partyId,REGION region,CATEGORY category,GENERAL_HEADQUARTERS generalHeadquarters,GENRE genre,
  	 LISTED listed,STOCK_CODE stockCode,IS_CORE isCore,VENDOR_MOV_STATUS vendorMovStatus,SKU_MOV_STATUS skuMovStatus,	 
  	 ORDER_VERIFY orderVerify,IS_SHOW_NAME isShowName,
  	 IS_SUP_PRICE isSupPrice,SUPPORT_CURRENCY supportCurrency,DESCRIPTION description,COMMENTS comments,SUPPLIER_STATUS supplierStatus,
  	 MIN_ORDER_AMOUNT_CNY minOrderPriceCNY,MIN_ORDER_AMOUNT_USD minOrderPriceUSD
  	 from PARTY_SUPPLIER where 1=1 
  	 <if test="list !=null and list.size()>0">
  	 	and PARTY_ID in
  	 <foreach item="item" index="index" collection="list" open="(" separator="," close=")">#{item}</foreach>
  	 </if>
  </select>
  
  
   <select id="getCheckInfo" resultType="com.yikuyi.party.vendor.vo.VendorInfoVo">
  	 select t1.PARTY_CODE as partyCode,
  	        t2.GROUP_NAME as groupName,
  	        t2.GROUP_NAME_FULL as groupNameFull,
  	        t3.CATEGORY as category,
  	        t3.IS_CORE as isCore 
  	   from PARTY t1,PARTY_GROUP t2,PARTY_SUPPLIER t3 
  	   where t1.PARTY_ID = t2.PARTY_ID 
  	   and t1.PARTY_ID = t3.PARTY_ID 
  	   and t1.PARTY_ID =#{partyId}  	
  </select>
  
  
  <update id="updateVendorInfoVo" parameterType="com.yikuyi.party.vendor.vo.PartySupplier" >
     update PARTY_SUPPLIER SET   
         REGION = #{region},				
		 GENERAL_HEADQUARTERS = #{generalHeadquarters},
		 GENRE = #{genre},	
		 LISTED = #{listed},				
		 STOCK_CODE = #{stockCode},			
   		 LAST_UPDATE_USER = #{lastUpdateUser},	
		 LAST_UPDATE_DATE = #{lastUpdateDate}	
	 where PARTY_ID = #{partyId}
  </update>
  
   <update id="update" parameterType="com.yikuyi.party.vendor.vo.PartySupplier" >
     update PARTY_SUPPLIER 
     <set>
     	<if test="isCore !=null ">
     		IS_CORE = #{isCore},
     	</if>
     	<if test="category !=null ">
     		CATEGORY = #{category},
     	</if>
     </set>
     where PARTY_ID = #{partyId}
  </update>
  
  <select id="findCodeAndRegion" resultType="com.yikuyi.party.vendor.vo.PartySupplier">
  	 select t1.PARTY_CODE as category,
  	        t2.REGION as region
  	   from PARTY t1,PARTY_SUPPLIER t2 
  	   where t1.PARTY_ID = t2.PARTY_ID  	  
  	   and t1.PARTY_ID =#{partyId}  	
  </select>
  
  <delete id="deleteByPartyId" parameterType="java.lang.String"> 
         DELETE FROM PARTY_SUPPLIER WHERE PARTY_ID = #{partyId}
  </delete>
  
  
   <select id="getSupplierDetail" resultType="com.yikuyi.party.vendor.vo.PartySupplier" parameterType="java.lang.String">
	 SELECT t.`IS_SUP_PRICE` AS isSupPrice,t.`IS_SHOW_NAME` AS isShowName,t.`SKU_MOV_STATUS` AS skuMovStatus,t.`VENDOR_MOV_STATUS` AS vendorMovStatus FROM `PARTY_SUPPLIER` t
	 WHERE t.`PARTY_ID`=#{partyId} 	  
  </select>
	
</mapper>