<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.yikuyi.product.activity.dao.ActivityProductDraftDao" >
  <resultMap id="BaseResultMap" type="com.yikuyi.activity.model.ActivityProductDraft" >
    <id column="ACTIVITY_PRODUCT_ID" property="activityProductId" jdbcType="VARCHAR" />
    <result column="ACTIVITY_ID" property="activityId" jdbcType="VARCHAR" />
    <result column="PERIODS_ID" property="periodsId" jdbcType="VARCHAR" />
    <result column="PRODUCT_ID" property="productId" jdbcType="VARCHAR" />
    <result column="MANUFACTURER_PART_NUMBER" property="manufacturerPartNumber" jdbcType="VARCHAR" />
    <result column="MANUFACTURER" property="manufacturer" jdbcType="VARCHAR" />
    <result column="SOURCE_ID" property="sourceId" jdbcType="VARCHAR" />
    <result column="SOURCE_NAME" property="sourceName" jdbcType="VARCHAR" />
    <result column="VENDOR_ID" property="vendorId" jdbcType="VARCHAR" />
    <result column="VENDOR_NAME" property="vendorName" jdbcType="VARCHAR" />
    <result column="DISCOUNT" property="discount" jdbcType="VARCHAR" />
    <result column="CURRENCY_UOM_ID" property="currencyUomId" jdbcType="VARCHAR" />
    <result column="QTY_BREAK_1" property="qtyBreak1" jdbcType="VARCHAR" />
    <result column="PRICE_BREAK_1" property="priceBreak1" jdbcType="VARCHAR" />
    <result column="QTY_BREAK_2" property="qtyBreak2" jdbcType="VARCHAR" />
    <result column="PRICE_BREAK_2" property="priceBreak2" jdbcType="VARCHAR" />
    <result column="QTY_BREAK_3" property="qtyBreak3" jdbcType="VARCHAR" />
    <result column="PRICE_BREAK_3" property="priceBreak3" jdbcType="VARCHAR" />
    <result column="QTY_BREAK_4" property="qtyBreak4" jdbcType="VARCHAR" />
    <result column="PRICE_BREAK_4" property="priceBreak4" jdbcType="VARCHAR" />
    <result column="QTY_BREAK_5" property="qtyBreak5" jdbcType="VARCHAR" />
    <result column="PRICE_BREAK_5" property="priceBreak5" jdbcType="VARCHAR" />
    <result column="TITLE" property="title" jdbcType="VARCHAR" />
    <result column="SUB_TITLE" property="subTitle" jdbcType="VARCHAR" />
    <result column="IMAGE_1" property="image1" jdbcType="VARCHAR" />
    <result column="IMAGE_2" property="image2" jdbcType="VARCHAR" />
    <result column="IMAGE_3" property="image3" jdbcType="VARCHAR" />
    <result column="IMAGE_4" property="image4" jdbcType="VARCHAR" />
    <result column="IMAGE_5" property="image5" jdbcType="VARCHAR" />
    <result column="DESCRIPTION" property="description" />
    <result column="STATUS" property="status" jdbcType="VARCHAR" />
    <result column="DESC" property="desc" />
    <result column="TOTAL_QTY" property="totalQty" jdbcType="VARCHAR" />
    <result column="CATEGORY_3_NAME" property="category3Name" />
    <result column="CATEGORY_3_ID" property="category3Id" />
    <result column="PROCESS_ID" property="processId" />
  </resultMap>
    <resultMap id="DraftVoBaseResultMap" type="com.yikuyi.activity.vo.ActivityProductDraftVo" >
    <id column="ACTIVITY_PRODUCT_ID" property="activityProductId" jdbcType="VARCHAR" />
    <result column="ACTIVITY_ID" property="activityId" jdbcType="VARCHAR" />
    <result column="PERIODS_ID" property="periodsId" jdbcType="VARCHAR" />
    <result column="PRODUCT_ID" property="productId" jdbcType="VARCHAR" />
    <result column="MANUFACTURER_PART_NUMBER" property="manufacturerPartNumber" jdbcType="VARCHAR" />
    <result column="MANUFACTURER" property="manufacturer" jdbcType="VARCHAR" />
    <result column="SOURCE_ID" property="sourceId" jdbcType="VARCHAR" />
    <result column="SOURCE_NAME" property="sourceName" jdbcType="VARCHAR" />
    <result column="VENDOR_ID" property="vendorId" jdbcType="VARCHAR" />
    <result column="VENDOR_NAME" property="vendorName" jdbcType="VARCHAR" />
    <result column="DISCOUNT" property="discount" jdbcType="VARCHAR" />
    <result column="CURRENCY_UOM_ID" property="currencyUomId" jdbcType="VARCHAR" />
    <result column="QTY_BREAK_1" property="qtyBreak1" jdbcType="VARCHAR" />
    <result column="PRICE_BREAK_1" property="priceBreak1" jdbcType="VARCHAR" />
    <result column="QTY_BREAK_2" property="qtyBreak2" jdbcType="VARCHAR" />
    <result column="PRICE_BREAK_2" property="priceBreak2" jdbcType="VARCHAR" />
    <result column="QTY_BREAK_3" property="qtyBreak3" jdbcType="VARCHAR" />
    <result column="PRICE_BREAK_3" property="priceBreak3" jdbcType="VARCHAR" />
    <result column="QTY_BREAK_4" property="qtyBreak4" jdbcType="VARCHAR" />
    <result column="PRICE_BREAK_4" property="priceBreak4" jdbcType="VARCHAR" />
    <result column="QTY_BREAK_5" property="qtyBreak5" jdbcType="VARCHAR" />
    <result column="PRICE_BREAK_5" property="priceBreak5" jdbcType="VARCHAR" />
    <result column="TITLE" property="title" jdbcType="VARCHAR" />
    <result column="SUB_TITLE" property="subTitle" jdbcType="VARCHAR" />
    <result column="IMAGE_1" property="image1" jdbcType="VARCHAR" />
    <result column="IMAGE_2" property="image2" jdbcType="VARCHAR" />
    <result column="IMAGE_3" property="image3" jdbcType="VARCHAR" />
    <result column="IMAGE_4" property="image4" jdbcType="VARCHAR" />
    <result column="IMAGE_5" property="image5" jdbcType="VARCHAR" />
    <result column="CATEGORY_3_NAME" property="category3Name" />
    <result column="CATEGORY_3_ID" property="category3Id" />
    <result column="PROCESS_ID" property="processId" />
    <result column="DESCRIPTION" property="description" jdbcType="VARCHAR" />
    <result column="STATUS" property="status" jdbcType="VARCHAR" />
    <result column="DESC" property="desc" jdbcType="VARCHAR" />
    <result column="TOTAL_QTY" property="totalQty" jdbcType="VARCHAR" />
  </resultMap>
  <resultMap id="DraftBaseResultMap" type="com.yikuyi.activity.model.ActivityProduct" >
    <id column="ACTIVITY_PRODUCT_ID" property="activityProductId" />
    <result column="ACTIVITY_ID" property="activityId"  />
    <result column="PERIODS_ID" property="periodsId" />
    <result column="PRODUCT_ID" property="productId" />
    <result column="MANUFACTURER_PART_NUMBER" property="manufacturerPartNumber" />
    <result column="MANUFACTURER" property="manufacturer" />
    <result column="SOURCE_ID" property="sourceId" />
    <result column="SOURCE_NAME" property="sourceName"/>
    <result column="VENDOR_ID" property="vendorId" />
    <result column="VENDOR_NAME" property="vendorName" />
    <result column="DISCOUNT" property="discount" />
    <result column="CURRENCY_UOM_ID" property="currencyUomId" />
    <result column="QTY_BREAK_1" property="qtyBreak1" />
    <result column="PRICE_BREAK_1" property="priceBreak1" />
    <result column="QTY_BREAK_2" property="qtyBreak2" />
    <result column="PRICE_BREAK_2" property="priceBreak2"/>
    <result column="QTY_BREAK_3" property="qtyBreak3" />
    <result column="PRICE_BREAK_3" property="priceBreak3" />
    <result column="QTY_BREAK_4" property="qtyBreak4" />
    <result column="PRICE_BREAK_4" property="priceBreak4" />
    <result column="QTY_BREAK_5" property="qtyBreak5" />
    <result column="PRICE_BREAK_5" property="priceBreak5" />
    <result column="TITLE" property="title" />
    <result column="SUB_TITLE" property="subTitle" />
    <result column="IMAGE_1" property="image1" />
    <result column="IMAGE_2" property="image2" />
    <result column="IMAGE_3" property="image3" />
    <result column="IMAGE_4" property="image4" />
    <result column="IMAGE_5" property="image5" />
    <result column="TOTAL_QTY" property="totalQty" />
    <result column="DESCRIPTION" property="description" />
    <result column="CATEGORY_3_NAME" property="category3Name" />
    <result column="CATEGORY_3_ID" property="category3Id" />
    <result column="PROCESS_ID" property="processId" />
  </resultMap>
  <sql id="Base_Column_List" >
    ACTIVITY_PRODUCT_ID, ACTIVITY_ID, PERIODS_ID, PRODUCT_ID, MANUFACTURER_PART_NUMBER, 
    MANUFACTURER, SOURCE_ID, SOURCE_NAME, VENDOR_ID, VENDOR_NAME, DISCOUNT, CURRENCY_UOM_ID, 
    QTY_BREAK_1, PRICE_BREAK_1, QTY_BREAK_2, PRICE_BREAK_2, QTY_BREAK_3, PRICE_BREAK_3, 
    QTY_BREAK_4, PRICE_BREAK_4, QTY_BREAK_5, PRICE_BREAK_5, TITLE, SUB_TITLE, IMAGE_1, 
    IMAGE_2, IMAGE_3, IMAGE_4, IMAGE_5,DESCRIPTION, STATUS, `DESC`, TOTAL_QTY,CATEGORY_3_NAME,CATEGORY_3_ID
  </sql>
  
	<select id="getProductById" parameterType="java.lang.String" resultMap="BaseResultMap">
		SELECT <include refid="Base_Column_List"/> FROM ACTIVITY_PRODUCT_DRAFT WHERE ACTIVITY_PRODUCT_ID = #{id}
	</select>
	<select id="getProductByActivityId" parameterType="java.lang.String" resultMap="DraftBaseResultMap">
		SELECT <include refid="Base_Column_List"/> FROM ACTIVITY_PRODUCT_DRAFT WHERE ACTIVITY_ID = #{id} and STATUS = 'ENABLE'
	</select>
  
	<select id="getProductByCondition" parameterType="com.yikuyi.activity.model.ActivityProductDraft" resultMap="BaseResultMap">
		SELECT <include refid="Base_Column_List"/> FROM ACTIVITY_PRODUCT_DRAFT 
		<where>     
	        <if test="activityId !=null">     
	            ACTIVITY_ID = #{activityId}      
	        </if>     
	        <if test="periodsId != null">     
	            AND PERIODS_ID = #{periodsId}      
	        </if>
	        <if test="status != null">     
	            AND STATUS = #{status}      
	        </if>     
	    </where> 
	</select>
	<select id="getProductByIds"  resultMap="BaseResultMap">
		SELECT <include refid="Base_Column_List"/> FROM ACTIVITY_PRODUCT_DRAFT 
		where ACTIVITY_PRODUCT_ID in
	        <foreach collection="ids" item="id" index="index"
	            open="(" close=")" separator=",">
	            #{id}
	        </foreach>
	</select>
	
  <insert id="save" parameterType="com.yikuyi.activity.model.ActivityProductDraft" >
    insert into ACTIVITY_PRODUCT_DRAFT
    <trim prefix="(" suffix=")" suffixOverrides="," >
      <if test="activityProductId != null" >
        ACTIVITY_PRODUCT_ID,
      </if>
      <if test="activityId != null" >
        ACTIVITY_ID,
      </if>
      <if test="periodsId != null" >
        PERIODS_ID,
      </if>
      <if test="productId != null" >
        PRODUCT_ID,
      </if>
      <if test="manufacturerPartNumber != null" >
        MANUFACTURER_PART_NUMBER,
      </if>
      <if test="manufacturer != null" >
        MANUFACTURER,
      </if>
      <if test="sourceId != null" >
        SOURCE_ID,
      </if>
      <if test="sourceName != null" >
        SOURCE_NAME,
      </if>
      <if test="vendorId != null" >
        VENDOR_ID,
      </if>
      <if test="vendorName != null" >
        VENDOR_NAME,
      </if>
      <if test="discount != null" >
        DISCOUNT,
      </if>
      <if test="currencyUomId != null" >
        CURRENCY_UOM_ID,
      </if>
      <if test="qtyBreak1 != null" >
        QTY_BREAK_1,
      </if>
      <if test="priceBreak1 != null" >
        PRICE_BREAK_1,
      </if>
      <if test="qtyBreak2 != null" >
        QTY_BREAK_2,
      </if>
      <if test="priceBreak2 != null" >
        PRICE_BREAK_2,
      </if>
      <if test="qtyBreak3 != null" >
        QTY_BREAK_3,
      </if>
      <if test="priceBreak3 != null" >
        PRICE_BREAK_3,
      </if>
      <if test="qtyBreak4 != null" >
        QTY_BREAK_4,
      </if>
      <if test="priceBreak4 != null" >
        PRICE_BREAK_4,
      </if>
      <if test="qtyBreak5 != null" >
        QTY_BREAK_5,
      </if>
      <if test="priceBreak5 != null" >
        PRICE_BREAK_5,
      </if>
      <if test="title != null" >
        TITLE,
      </if>
      <if test="subTitle != null" >
        SUB_TITLE,
      </if>
      <if test="image1 != null" >
        IMAGE_1,
      </if>
      <if test="image2 != null" >
        IMAGE_2,
      </if>
      <if test="image3 != null" >
        IMAGE_3,
      </if>
      <if test="image4 != null" >
        IMAGE_4,
      </if>
      <if test="image5 != null" >
        IMAGE_5,
      </if>
      <if test="description != null" >
        DESCRIPTION,
      </if>
      <if test="status != null" >
        STATUS,
      </if>
      <if test="desc != null" >
        `DESC`,
      </if>
      <if test="totalQty != null" >
        TOTAL_QTY,
      </if>
      <if test="category3Name != null" >
        CATEGORY_3_NAME,
      </if>
      <if test="category3Id != null" >
        CATEGORY_3_ID,
      </if>
      <if test="processId != null" >
        PROCESS_ID,
      </if>
      LAST_UPDATE_DATE
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides="," >
      <if test="activityProductId != null" >
        #{activityProductId,jdbcType=VARCHAR},
      </if>
      <if test="activityId != null" >
        #{activityId,jdbcType=VARCHAR},
      </if>
      <if test="periodsId != null" >
        #{periodsId,jdbcType=VARCHAR},
      </if>
      <if test="productId != null" >
        #{productId,jdbcType=VARCHAR},
      </if>
      <if test="manufacturerPartNumber != null" >
        #{manufacturerPartNumber,jdbcType=VARCHAR},
      </if>
      <if test="manufacturer != null" >
        #{manufacturer,jdbcType=VARCHAR},
      </if>
      <if test="sourceId != null" >
        #{sourceId,jdbcType=VARCHAR},
      </if>
      <if test="sourceName != null" >
        #{sourceName,jdbcType=VARCHAR},
      </if>
      <if test="vendorId != null" >
        #{vendorId,jdbcType=VARCHAR},
      </if>
      <if test="vendorName != null" >
        #{vendorName,jdbcType=VARCHAR},
      </if>
      <if test="discount != null" >
        #{discount,jdbcType=VARCHAR},
      </if>
      <if test="currencyUomId != null" >
        #{currencyUomId,jdbcType=VARCHAR},
      </if>
      <if test="qtyBreak1 != null" >
        #{qtyBreak1,jdbcType=VARCHAR},
      </if>
      <if test="priceBreak1 != null" >
        #{priceBreak1,jdbcType=VARCHAR},
      </if>
      <if test="qtyBreak2 != null" >
        #{qtyBreak2,jdbcType=VARCHAR},
      </if>
      <if test="priceBreak2 != null" >
        #{priceBreak2,jdbcType=VARCHAR},
      </if>
      <if test="qtyBreak3 != null" >
        #{qtyBreak3,jdbcType=VARCHAR},
      </if>
      <if test="priceBreak3 != null" >
        #{priceBreak3,jdbcType=VARCHAR},
      </if>
      <if test="qtyBreak4 != null" >
        #{qtyBreak4,jdbcType=VARCHAR},
      </if>
      <if test="priceBreak4 != null" >
        #{priceBreak4,jdbcType=VARCHAR},
      </if>
      <if test="qtyBreak5 != null" >
        #{qtyBreak5,jdbcType=VARCHAR},
      </if>
      <if test="priceBreak5 != null" >
        #{priceBreak5,jdbcType=VARCHAR},
      </if>
      <if test="title != null" >
        #{title,jdbcType=VARCHAR},
      </if>
      <if test="subTitle != null" >
        #{subTitle,jdbcType=VARCHAR},
      </if>
      <if test="image1 != null" >
        #{image1,jdbcType=VARCHAR},
      </if>
      <if test="image2 != null" >
        #{image2,jdbcType=VARCHAR},
      </if>
      <if test="image3 != null" >
        #{image3,jdbcType=VARCHAR},
      </if>
      <if test="image4 != null" >
        #{image4,jdbcType=VARCHAR},
      </if>
      <if test="image5 != null" >
        #{image5,jdbcType=VARCHAR},
      </if>
      <if test="description != null" >
        #{description},
      </if>
      <if test="status != null" >
        #{status,jdbcType=VARCHAR},
      </if>
      <if test="desc != null" >
        #{desc,jdbcType=VARCHAR},
      </if>
      <if test="totalQty != null" >
        #{totalQty,jdbcType=VARCHAR},
      </if>
      <if test="category3Name != null" >
        #{category3Name},
      </if>
      <if test="category3Id != null" >
        #{category3Id},
      </if>
      <if test="processId != null" >
        #{processId},
      </if>
      now()
    </trim>
  </insert>
  
	<update id="editProductInfo" parameterType="com.yikuyi.activity.model.ActivityProductDraft">
		UPDATE ACTIVITY_PRODUCT_DRAFT
		<set>
	      <if test="activityId != null" >
	        ACTIVITY_ID = #{activityId},
	      </if>
	      <if test="periodsId != null" >
	        PERIODS_ID = #{periodsId},
	      </if>
	      <if test="productId != null" >
	        PRODUCT_ID = #{productId},
	      </if>
	      <if test="manufacturerPartNumber != null" >
	        MANUFACTURER_PART_NUMBER = #{manufacturerPartNumber},
	      </if>
	      <if test="manufacturer != null" >
	        MANUFACTURER = #{manufacturer},
	      </if>
	      <if test="sourceId != null" >
	        SOURCE_ID = #{sourceId},
	      </if>
	      <if test="sourceName != null" >
	        SOURCE_NAME = #{sourceName},
	      </if>
	      <if test="vendorId != null" >
	        VENDOR_ID = #{vendorId},
	      </if>
	      <if test="vendorName != null" >
	        VENDOR_NAME = #{vendorName},
	      </if>
	      <if test="discount != null" >
	        DISCOUNT = #{discount},
	      </if>
	      <if test="currencyUomId != null" >
	        CURRENCY_UOM_ID = #{currencyUomId},
	      </if>
	      <if test="qtyBreak1 != null" >
	        QTY_BREAK_1 = #{qtyBreak1},
	      </if>
	      <if test="priceBreak1 != null" >
	        PRICE_BREAK_1 = #{priceBreak1},
	      </if>
	      <if test="qtyBreak2 != null" >
	        QTY_BREAK_2 = #{qtyBreak2},
	      </if>
	      <if test="priceBreak2 != null" >
	        PRICE_BREAK_2 = #{priceBreak2},
	      </if>
	      <if test="qtyBreak3 != null" >
	        QTY_BREAK_3 = #{qtyBreak3},
	      </if>
	      <if test="priceBreak3 != null" >
	        PRICE_BREAK_3 = #{priceBreak3},
	      </if>
	      <if test="qtyBreak4 != null" >
	        QTY_BREAK_4 = #{qtyBreak4},
	      </if>
	      <if test="priceBreak4 != null" >
	        PRICE_BREAK_4 = #{priceBreak4},
	      </if>
	      <if test="qtyBreak5 != null" >
	        QTY_BREAK_5 = #{qtyBreak5},
	      </if>
	      <if test="priceBreak5 != null" >
	        PRICE_BREAK_5 = #{priceBreak5},
	      </if>
	      <if test="title != null" >
	        TITLE = #{title},
	      </if>
	      <if test="subTitle != null" >
	        SUB_TITLE = #{subTitle},
	      </if>
	      <if test="image1 != null" >
	        IMAGE_1 = #{image1},
	      </if>
	      <if test="image2 != null" >
	        IMAGE_2 = #{image2},
	      </if>
	      <if test="image3 != null" >
	        IMAGE_3 = #{image3},
	      </if>
	      <if test="image4 != null" >
	        IMAGE_4 = #{image4},
	      </if>
	      <if test="image5 != null" >
	        IMAGE_5 = #{image5},
	      </if>
	      <if test="description != null" >
	        DESCRIPTION = #{description},
	      </if>
	      <if test="status != null" >
	        STATUS = #{status},
	      </if>
	      <if test="desc != null" >
	        `DESC` = #{desc},
	      </if>
	      <if test="totalQty != null" >
	        TOTAL_QTY = #{totalQty},
	      </if>
	      <if test="category3Name != null" >
	        CATEGORY_3_NAME = #{category3Name},
	      </if>
	      <if test="category3Id != null" >
	        CATEGORY_3_ID = #{category3Id},
	      </if>
	      <if test="processId != null" >
	        PROCESS_ID = #{processId},
	      </if>
			LAST_UPDATE_DATE = NOW(),
		</set>
		WHERE ACTIVITY_PRODUCT_ID = #{activityProductId}
	</update>
  
	  <delete id="deleteByActivityId">
	  	DELETE FROM ACTIVITY_PRODUCT_DRAFT WHERE ACTIVITY_ID = #{id}
	  </delete>
	  
	  <insert id="saveActivityProductDraft" parameterType="java.util.List">
	  	INSERT INTO ACTIVITY_PRODUCT_DRAFT
	  	(
	      	`ACTIVITY_PRODUCT_ID`,
		  	`ACTIVITY_ID`,
			`PERIODS_ID`,
		  	`PRODUCT_ID`,
		  	`MANUFACTURER_PART_NUMBER`,
		 	`MANUFACTURER`,
		 	`SOURCE_ID`,
		 	`SOURCE_NAME`,
		 	`VENDOR_ID`,
		 	`VENDOR_NAME`,
		 	`CURRENCY_UOM_ID`,
		 	`QTY_BREAK_1`,
		 	`PRICE_BREAK_1`,
		 	`QTY_BREAK_2`,
		 	`PRICE_BREAK_2`,
		 	`QTY_BREAK_3`,
		 	`PRICE_BREAK_3`,
		 	`QTY_BREAK_4`,
		 	`PRICE_BREAK_4`,
		 	`QTY_BREAK_5`,
		 	`PRICE_BREAK_5`,
		 	`IMAGE_1`,
		 	`STATUS`,
		 	`DESC`,
		 	`TOTAL_QTY`,
		 	 DESCRIPTION,
		`LAST_UPDATE_DATE`
		)
		 values
		   <foreach collection ="list" item="item" index= "index" separator =",">
		   (
   		  	#{item.activityProductId},
		  	#{item.activityId},
			#{item.periodsId},
		  	#{item.productId},
		 	#{item.manufacturerPartNumber},
		 	#{item.manufacturer},
		 	#{item.sourceId},
		 	#{item.sourceName},
		 	#{item.vendorId},
		 	#{item.vendorName},
		 	#{item.currencyUomId},
		 	#{item.qtyBreak1},
		 	#{item.priceBreak1},
		 	#{item.qtyBreak2},
		 	#{item.priceBreak2},
		 	#{item.qtyBreak3},
		 	#{item.priceBreak3},
		 	#{item.qtyBreak4},
		 	#{item.priceBreak4},
		 	#{item.qtyBreak5},
		 	#{item.priceBreak5},
		 	#{item.image1},
		 	#{item.status},
		 	#{item.desc},
		 	#{item.totalQty},
		 	#{item.description},
			now()
			)
		</foreach>
	  </insert>
	  
	  <delete id="deleteActivityProductDraft">
	  	DELETE FROM ACTIVITY_PRODUCT_DRAFT WHERE ACTIVITY_PRODUCT_ID = #{activityProductId}
	  </delete>
	  
	  <delete id="deleteActivityProductDraftBatch" parameterType="java.util.List">
	  	DELETE FROM ACTIVITY_PRODUCT_DRAFT WHERE ACTIVITY_PRODUCT_ID IN
	  	<foreach collection ="list" item="item" open="(" separator ="," close=")">
	  		#{item}
	  	</foreach>
	  </delete>
	  
	  <select id="findActivityProductDraftByCondition" resultMap="DraftVoBaseResultMap">
		SELECT 
		  `ACTIVITY_PRODUCT_ID`,
		  `ACTIVITY_ID`,
		  `PERIODS_ID`,
		  `PRODUCT_ID`,
		  `MANUFACTURER_PART_NUMBER`,
		  `MANUFACTURER`,
		  `SOURCE_ID`,
		  `SOURCE_NAME`,
		  `VENDOR_ID`,
		  `VENDOR_NAME`,
		  `DISCOUNT`,
		  `CURRENCY_UOM_ID`,
		  `QTY_BREAK_1`,
		  `PRICE_BREAK_1`,
		  `QTY_BREAK_2`,
		  `PRICE_BREAK_2`,
		  `QTY_BREAK_3`,
		  `PRICE_BREAK_3`,
		  `QTY_BREAK_4`,
		  `PRICE_BREAK_4`,
		  `QTY_BREAK_5`,
		  `PRICE_BREAK_5`,
		  `TITLE`,
		  `SUB_TITLE`,
		  `IMAGE_1`,
		  `IMAGE_2`,
		  `IMAGE_3`,
		  `IMAGE_4`,
		  `IMAGE_5`,
		  `CATEGORY_3_ID`,
		  `CATEGORY_3_NAME`,
		  `DESCRIPTION`,
		  `STATUS`,
		  `DESC`,
		  `TOTAL_QTY`,
		  `LAST_UPDATE_DATE` 
		FROM
		  ACTIVITY_PRODUCT_DRAFT
		  <where>
		  	<if test="activityId !=null">     
	           AND ACTIVITY_ID = #{activityId}      
	        </if>     
	        <if test="periodsId != null">     
	            AND PERIODS_ID = #{periodsId}      
	        </if>
	        <if test="status != null">     
	            AND STATUS = #{status}      
	        </if>
	        <if test="processId != null">     
	            AND PROCESS_ID = #{processId}      
	        </if> 
		  </where>
	  </select>
	  
	  <update id="updateActivityProductDraftByCondition">
	  	UPDATE ACTIVITY_PRODUCT_DRAFT
		<set>
	      <if test="activityId != null" >
	        ACTIVITY_ID = #{activityId},
	      </if>
	      <if test="periodsId != null" >
	        PERIODS_ID = #{periodsId},
	      </if>
	      <if test="productId != null" >
	        PRODUCT_ID = #{productId},
	      </if>
	      <if test="manufacturerPartNumber != null" >
	        MANUFACTURER_PART_NUMBER = #{manufacturerPartNumber},
	      </if>
	      <if test="manufacturer != null" >
	        MANUFACTURER = #{manufacturer},
	      </if>
	      <if test="sourceId != null" >
	        SOURCE_ID = #{sourceId},
	      </if>
	      <if test="sourceName != null" >
	        SOURCE_NAME = #{sourceName},
	      </if>
	      <if test="vendorId != null" >
	        VENDOR_ID = #{vendorId},
	      </if>
	      <if test="vendorName != null" >
	        VENDOR_NAME = #{vendorName},
	      </if>
	      <if test="discount != null" >
	        DISCOUNT = #{discount},
	      </if>
	      <if test="currencyUomId != null" >
	        CURRENCY_UOM_ID = #{currencyUomId},
	      </if>
	      <if test="qtyBreak1 != null" >
	        QTY_BREAK_1 = #{qtyBreak1},
	      </if>
	      <if test="priceBreak1 != null" >
	        PRICE_BREAK_1 = #{priceBreak1},
	      </if>
	      <if test="qtyBreak2 != null" >
	        QTY_BREAK_2 = #{qtyBreak2},
	      </if>
	      <if test="priceBreak2 != null" >
	        PRICE_BREAK_2 = #{priceBreak2},
	      </if>
	      <if test="qtyBreak3 != null" >
	        QTY_BREAK_3 = #{qtyBreak3},
	      </if>
	      <if test="priceBreak3 != null" >
	        PRICE_BREAK_3 = #{priceBreak3},
	      </if>
	      <if test="qtyBreak4 != null" >
	        QTY_BREAK_4 = #{qtyBreak4},
	      </if>
	      <if test="priceBreak4 != null" >
	        PRICE_BREAK_4 = #{priceBreak4},
	      </if>
	      <if test="qtyBreak5 != null" >
	        QTY_BREAK_5 = #{qtyBreak5},
	      </if>
	      <if test="priceBreak5 != null" >
	        PRICE_BREAK_5 = #{priceBreak5},
	      </if>
	      <if test="title != null" >
	        TITLE = #{title},
	      </if>
	      <if test="subTitle != null" >
	        SUB_TITLE = #{subTitle},
	      </if>
	      <if test="image1 != null" >
	        IMAGE_1 = #{image1},
	      </if>
	      <if test="image2 != null" >
	        IMAGE_2 = #{image2},
	      </if>
	      <if test="image3 != null" >
	        IMAGE_3 = #{image3},
	      </if>
	      <if test="image4 != null" >
	        IMAGE_4 = #{image4},
	      </if>
	      <if test="image5 != null" >
	        IMAGE_5 = #{image5},
	      </if>
	      <if test="status != null" >
	        STATUS = #{status},
	      </if>
	      <if test="desc != null" >
	        `DESC` = #{desc},
	      </if>
	      <if test="totalQty != null" >
	        TOTAL_QTY = #{totalQty},
	      </if>
			LAST_UPDATE_DATE = NOW(),
		</set>
		<where>
			<if test="activityId != null">
				AND ACTIVITY_ID = #{activityId}
			</if>
			<if  test="periodsId != null">
				 AND PERIODS_ID = #{periodsId}      
			</if>
			<if test="manufacturer != null">
				AND MANUFACTURER = #{manufacturer}
			</if>
			<if test="manufacturerPartNumber != null" >
				AND MANUFACTURER_PART_NUMBER = #{manufacturerPartNumber}
			</if>
			<if test="sourceName != null" >
				SOURCE_NAME = #{sourceName}
			</if>
			<if test="vendorName != null">
				VENDOR_NAME = #{vendorName}
			</if>
		</where>
	  </update>
	  
	  <select id="findProductDraftByCondition" resultMap="BaseResultMap">
	  		SELECT 
		  `ACTIVITY_PRODUCT_ID`,
		  `ACTIVITY_ID`,
		  `PERIODS_ID`,
		  `PRODUCT_ID`,
		  `MANUFACTURER_PART_NUMBER`,
		  `MANUFACTURER`,
		  `SOURCE_ID`,
		  `SOURCE_NAME`,
		  `VENDOR_ID`,
		  `VENDOR_NAME`,
		  `DISCOUNT`,
		  `CURRENCY_UOM_ID`,
		  `QTY_BREAK_1`,
		  `PRICE_BREAK_1`,
		  `QTY_BREAK_2`,
		  `PRICE_BREAK_2`,
		  `QTY_BREAK_3`,
		  `PRICE_BREAK_3`,
		  `QTY_BREAK_4`,
		  `PRICE_BREAK_4`,
		  `QTY_BREAK_5`,
		  `PRICE_BREAK_5`,
		  `TITLE`,
		  `SUB_TITLE`,
		  `IMAGE_1`,
		  `IMAGE_2`,
		  `IMAGE_3`,
		  `IMAGE_4`,
		  `IMAGE_5`,
		  `DESCRIPTION`,
		  `STATUS`,
		  `DESC`,
		  `TOTAL_QTY`,
		  `LAST_UPDATE_DATE` 
		FROM
		  ACTIVITY_PRODUCT_DRAFT
		  <where>
		  	<if test="activityId != null">
				AND ACTIVITY_ID = #{activityId}
			</if>
			<if  test="periodsId != null">
				 AND PERIODS_ID = #{periodsId}      
			</if>
			<if test="manufacturer != null">
				AND MANUFACTURER = #{manufacturer}
			</if>
			<if test="manufacturerPartNumber != null" >
				AND MANUFACTURER_PART_NUMBER = #{manufacturerPartNumber}
			</if>
			<if test="sourceName != null" >
				AND SOURCE_NAME = #{sourceName}
			</if>
			<if test="vendorName != null">
				AND VENDOR_NAME = #{vendorName}
			</if>
		  </where>
	  </select>
	  
  
  <!-- 将正式表的活动商品转移到草稿表中 -->
  <insert id="transProductsToDraft">
  	insert into ACTIVITY_PRODUCT_DRAFT (ACTIVITY_PRODUCT_ID,ACTIVITY_ID,PERIODS_ID,PRODUCT_ID,MANUFACTURER_PART_NUMBER,MANUFACTURER,SOURCE_ID,SOURCE_NAME,VENDOR_ID,VENDOR_NAME,DISCOUNT,
		CURRENCY_UOM_ID,QTY_BREAK_1,PRICE_BREAK_1,QTY_BREAK_2,PRICE_BREAK_2,QTY_BREAK_3,PRICE_BREAK_3,QTY_BREAK_4,PRICE_BREAK_4,QTY_BREAK_5,PRICE_BREAK_5,
		TITLE,SUB_TITLE,IMAGE_1,IMAGE_2,IMAGE_3,IMAGE_4,IMAGE_5,DESCRIPTION,STATUS,TOTAL_QTY,CATEGORY_3_NAME,CATEGORY_3_ID
  	)
  	select ACTIVITY_PRODUCT_ID,ACTIVITY_ID,PERIODS_ID,PRODUCT_ID,MANUFACTURER_PART_NUMBER,MANUFACTURER,SOURCE_ID,SOURCE_NAME,VENDOR_ID,VENDOR_NAME,DISCOUNT,
		CURRENCY_UOM_ID,QTY_BREAK_1,CAST(PRICE_BREAK_1 AS CHAR),QTY_BREAK_2,CAST(PRICE_BREAK_2 AS CHAR),QTY_BREAK_3,CAST(PRICE_BREAK_3 AS CHAR),QTY_BREAK_4,CAST(PRICE_BREAK_4 AS CHAR),QTY_BREAK_5,CAST(PRICE_BREAK_5 AS CHAR),
		TITLE,SUB_TITLE,IMAGE_1,IMAGE_2,IMAGE_3,IMAGE_4,IMAGE_5,DESCRIPTION,'ENABLE' AS STATUS,TOTAL_QTY,CATEGORY_3_NAME,CATEGORY_3_ID
	from ACTIVITY_PRODUCT where PERIODS_ID in
	<foreach item="id" collection="list" separator="," open="(" close=")" index="">    
      #{id}
    </foreach>    
  </insert>
</mapper>