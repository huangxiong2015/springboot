package com.ictrade.tools.leadin;

import java.io.File;
import java.nio.charset.Charset;

import com.ictrade.tools.FileUtils;
import com.ykyframework.exception.SystemException;

/**
 * 文件导入工具类，现在支持xls,xlsx,csv
 * @author tongkun@yikuyi.com
 * @version 1.0.0
 */
public class LeadInFactory {
	
	/**
	 * 工具类不需要构造方法
	 * @author tongkun@yikuyi.com
	 */
	private LeadInFactory(){}

	/**
	 * 读取
	 * @param leadInFile
	 * @return
	 */
	public static LeadInProcesser createProcess(File leadInFile){
		return createProcess(leadInFile,null,null);
	}

	/**
	 * 读取
	 * @param leadInFile
	 * @return
	 */
	public static LeadInProcesser createProcess(File leadInFile,String extra){
		return createProcess(leadInFile,extra,null);
	}
	
	/**
	 * 创建执行器
	 * @param leadInFile
	 * @since 2016年3月22日
	 * @author zr.tongkun@yikuyi.com
	 * @throws SystemException 
	 */
	public static LeadInProcesser createProcess(File leadInFile,String extra,Charset charset){
		LeadInProcesser result = null;
		//如果不是文件而是粘贴方式
		if(leadInFile==null && extra!=null){
			return new LeadInProcesserCopy(extra);
		}
		//如果是文件
		else if(leadInFile != null){
			String fileName = leadInFile.getName();//文件名
			String prefix = FileUtils.getPrefix(fileName);//后缀名
			prefix = prefix.toLowerCase();
			//csv类型
			if(LeadInProcesserCsv.FILE_TYPE.equals(prefix)){
				result = new LeadInProcesserCsv(leadInFile,charset);
			}
			//xls
			else if(LeadInProcesserXls.FILE_TYPE.equals(prefix)){
				result = new LeadInProcesserXls(leadInFile);
			}
			//xlsx
			else if(LeadInProcesserXlsx.FILE_TYPE.equals(prefix)){
				result = new LeadInProcesserXlsx(leadInFile);
			}
		}
		return result;
	}
}
