<!DOCTYPE html>
<%@ page language="java" contentType="text/html; charset=UTF-8" pageEncoding="UTF-8" %>
<%@taglib uri="http://java.sun.com/jsp/jstl/core" prefix="c"%>
<%@taglib uri="http://java.sun.com/jsp/jstl/fmt" prefix="fmt"%>
<c:set var="ctx" value="${pageContext.request.contextPath }" scope="request" />

<!--[if IE 8 ]>    <html class="ie8" lang="zh-CN"> <![endif]-->
<!--[if IE 9 ]>    <html class="ie9" lang="zh-CN"> <![endif]-->
<!--[if (gt IE 9)|!(IE)]><!-->
<html lang="zh-CN">
<!--<![endif]-->

<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
	<c:import url ="/WEB-INF/jsp/include/main/constants.jsp"/>
	<title>快递管理</title>
	<style>
		.col-xs-1{padding-left:0px; padding-right:0px;}
		.col-xs-1 label{margin-top:10px;}
		.col-xs-11 input{width:250px;}
		.reset_btn{border: 1px solid #e2e2e2;padding: 10px 15px;border-radius: 3px;margin-left:20px;}
		.reset_btn:hover{border-color:#b1191a;color:#919191;}
		.invalid{border:1px solid #b1191a;}
		.checktext{float:left;margin-top:10px;margin-left:10px;}
		.c_r{color:#b1191a;}
	</style>
	
</head>

<body class="hold-transition skin-blue sidebar-mini">
<div class="wrapper">

	<!---index header  start   ---->
	<jsp:directive.include file="../include/main/header.jsp" />
	<!---index header  end   ---->
	 <!---index nav  start   ---->
	<jsp:directive.include file="../include/main/menu.jsp" />
	<!---index nav  end   ---->
	  
	  <!-- 右边内容显示 -->
	  <div class="content-wrapper">
		<!-- Content Header (Page header) -->
		<section class="content-header">
			<a href="#" class="header_tab pitch_tab">快递管理</a>
		</section>
	    <!-- Main content -->
		<section ms-controller="list" class="content container-fluid ms-controller">	
			<div class="row mt30">
				<div class="col-xs-1 tr">
					<label>公司名称：</label>
				</div>
				<div class="col-xs-11">
					<input class="col_input_1 l add-groupName" type="text" name="addGroupName" onblur="groupName();">
					<input class="col_input_1 l edit-groupName" type="text" :duplex="@list[0].partyGroup.groupName" name="editGroupName" onblur="groupName();">
					<div class="checktext" style="margin-right:316px;display: none" id="groupNameHint"><span class="c_r f12">请填写公司名称</span></div>
				</div>
			</div>					
		</section>
		<!-- /.content -->
		<div style="margin-left:10%;padding-bottom:150px;margin-top:35px;">
			<a href="javascript:void(0);" onclick="save();" style="background: #b1191a;color: #fff;padding: 10px 15px;border-radius: 3px;">保存</a>
		 	<a href="${ctx}/shipmentlist.htm" class="reset_btn">取消</a>
		 </div>
	 
	</div>	  
	   
	<script type="text/javascript">
	var selectCatid = "857134796873138176,857135120568549376";
	</script>
	<!---footer  start   ---->
	<jsp:directive.include file="../include/main/footer.jsp" />
	<!---footer  end   ---->

</div>	    
<!-- ./wrapper -->
 <script>
 	
 	function getQueryObject(url) {
	    url = url == null ? window.location.href : url;
	    var search = url.substring(url.lastIndexOf("?") + 1);
	    var obj = {};
	    var reg = /([^?&=]+)=([^?&=]*)/g;
	    search.replace(reg, function (rs, $1, $2) {
	        var name = decodeURIComponent($1);
	        var val = decodeURIComponent($2);               
	        val = String(val);
	        obj[name] = val;
	        return rs;
	    });
	    return obj;
	}
 
 	var query = getQueryObject();
 	
 	var content = {"groupName" : ''};
 	
 	var detailList = avalon.define({
 		$id: "list",
 		list: [],
 		id:getQueryString("id")
 	});
 	
 	if(query.partyId){
 		$(".add-groupName").hide();
 		$(".edit-groupName").show();
 		$.aAjax({
 	 		 url: ykyUrl.party+'/v1/party/allparty',
 	 		 type: "PUT",
 	 	     data:JSON.stringify(query),
 	 	     success: function(data) {
 	 	    	detailList.list=data;
 	 	     }
 	 	})
 	}else{
 		$(".add-groupName").show();
 		$(".edit-groupName").hide();
 	}
 	
 	function save(){
 		if(query.partyId){
 			content.groupName=$('.edit-groupName').val();
 			content.partyId = query.partyId;
 			if(groupName()){
 		 		$.aAjax({
 					url: ykyUrl.party+"/v1/party/logistics",//ykyUrl.party
 					type:"put",
 					data:JSON.stringify(content),
 					success:function(data){
 						window.location.href=ykyUrl._this+"/shipmentlist.htm";
 					}
 				});
 	 		}
 		}else{
 			if(groupName()){
 				content.groupName=$('.add-groupName').val();
 		 		$.aAjax({
 					url: ykyUrl.party+"/v1/party/logistics",//ykyUrl.party
 					type:"POST",
 					data:JSON.stringify(content),
 					success:function(data){
 						window.location.href=ykyUrl._this+"/shipmentlist.htm";
 					}
 				});
 	 		}
 		}	
 	}

 	function groupName(){
 		//校验姓名
 		if(query.partyId){
 			var  name = $.trim($(".edit-groupName").val());
 			if(name===""){
 				$("#groupNameHint").show();
 				$(".edit-groupName").addClass("invalid");
 				return false;
 			}else{
 				$("#groupNameHint").hide();
 				$(".edit-groupName").removeClass("invalid");
 			}
 			$(".edit-groupName").val(name);
 			return true;
 		}else{
 			var  name = $.trim($(".add-groupName").val());
 			if(name===""){
 				$("#groupNameHint").show();
 				$(".add-groupName").addClass("invalid");
 				return false;
 			}else{
 				$("#groupNameHint").hide();
 				$(".add-groupName").removeClass("invalid");
 			}
 			$(".add-groupName").val(name);
 			return true;
 		}
		
 	}	
 </script>
</body>
</html>